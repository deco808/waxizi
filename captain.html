<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>船长的观察室 - 简洁版</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #0f172a;
            color: #e2e8f0;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow-x: hidden;
            position: relative;
            padding: 20px;
        }
        
        /* 简洁的背景纹理 */
        body::before {
            content: "";
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 10% 20%, rgba(30, 41, 59, 0.1) 0%, transparent 20%),
                radial-gradient(circle at 90% 80%, rgba(30, 41, 59, 0.1) 0%, transparent 20%);
            z-index: -1;
        }
        
        /* 游戏容器 */
        .game-container {
            width: 100%;
            max-width: 900px;
            min-height: 600px;
            background: rgba(15, 23, 42, 0.95);
            border-radius: 12px;
            padding: 30px;
            display: flex;
            flex-direction: column;
            gap: 25px;
            position: relative;
            z-index: 10;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(100, 130, 220, 0.15);
        }
        
        .header {
            text-align: center;
            padding-bottom: 20px;
            border-bottom: 1px solid rgba(100, 130, 220, 0.2);
        }
        
        .title {
            font-size: 2.8rem;
            font-weight: 700;
            color: #94a3b8;
            margin-bottom: 5px;
            letter-spacing: 1px;
        }
        
        .title span {
            color: #60a5fa;
            font-weight: 800;
        }
        
        .subtitle {
            font-size: 1.1rem;
            color: #94a3b8;
            margin-top: 8px;
            letter-spacing: 0.5px;
        }
        
        .time-display {
            font-size: 5rem;
            text-align: center;
            font-weight: 300;
            color: #60a5fa;
            margin: 10px 0;
            letter-spacing: 3px;
            font-family: 'Courier New', monospace;
        }
        
        .content-area {
            flex-grow: 1;
            background: rgba(30, 41, 59, 0.5);
            padding: 25px;
            border-radius: 8px;
            line-height: 1.8;
            font-size: 18px;
            color: #cbd5e1;
            border: 1px solid rgba(100, 130, 220, 0.1);
            overflow-y: auto;
        }
        
        .input-section {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .search-bar {
            width: 100%;
            padding: 14px 20px;
            background: rgba(30, 41, 59, 0.7);
            border: 1px solid #3b82f6;
            border-radius: 8px;
            color: #f1f5f9;
            font-size: 18px;
            outline: none;
            transition: all 0.3s;
        }
        
        .search-bar:focus {
            border-color: #60a5fa;
            box-shadow: 0 0 0 3px rgba(96, 165, 250, 0.2);
        }
        
        .info-panel {
            background: rgba(30, 41, 59, 0.7);
            padding: 18px;
            border-radius: 8px;
            font-size: 16px;
            line-height: 1.6;
            border: 1px solid rgba(100, 130, 220, 0.1);
        }
        
        .highlight {
            color: #60a5fa;
            font-weight: 600;
        }
        
        .example {
            color: #60a5fa;
            font-weight: 500;
            background: rgba(30, 41, 59, 0.8);
            padding: 2px 6px;
            border-radius: 4px;
            font-family: monospace;
        }
        
        .action-button {
            padding: 14px 25px;
            background: #1e40af;
            border: none;
            border-radius: 8px;
            color: #f1f5f9;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            margin-top: 5px;
            letter-spacing: 0.5px;
        }
        
        .action-button:hover {
            background: #3b82f6;
            transform: translateY(-2px);
        }
        
        /* 阅读视图样式 */
        .reading-view {
            display: none;
            min-height: 600px;
            padding: 30px;
            background: rgba(15, 23, 42, 0.98);
            border-radius: 12px;
            position: relative;
            border: 1px solid rgba(100, 130, 220, 0.15);
        }
        
        .back-button {
            position: absolute;
            top: 20px;
            left: 20px;
            padding: 8px 20px;
            background: rgba(30, 41, 59, 0.8);
            border: 1px solid #3b82f6;
            border-radius: 6px;
            color: #f1f5f9;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.3s;
        }
        
        .back-button:hover {
            background: #3b82f6;
        }
        
        .scene-title {
            text-align: center;
            font-size: 2.2rem;
            color: #60a5fa;
            margin-bottom: 30px;
            padding-bottom: 15px;
            border-bottom: 1px solid rgba(100, 130, 220, 0.2);
            font-weight: 600;
        }
        
        .dialog-text {
            white-space: pre-line;
            line-height: 1.8;
            font-size: 18px;
            background: rgba(30, 41, 59, 0.5);
            padding: 25px;
            border-radius: 8px;
            border: 1px solid rgba(100, 130, 220, 0.1);
            color: #cbd5e1;
        }
        
        .passenger-tag {
            display: inline-block;
            background: rgba(96, 165, 250, 0.1);
            border: 1px solid #3b82f6;
            border-radius: 6px;
            padding: 8px 15px;
            margin: 0 8px 8px 0;
            font-size: 16px;
        }
        
        /* 历史记录面板 */
        .history-panel {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(15, 23, 42, 0.98);
            width: 90%;
            max-width: 800px;
            max-height: 80vh;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.4);
            border: 1px solid rgba(100, 130, 220, 0.15);
            z-index: 100;
            overflow-y: auto;
        }
        
        .history-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid rgba(100, 130, 220, 0.2);
        }
        
        .history-title {
            font-size: 2rem;
            color: #60a5fa;
            font-weight: 600;
        }
        
        .close-history {
            padding: 8px 20px;
            background: rgba(30, 41, 59, 0.8);
            border: 1px solid #3b82f6;
            border-radius: 6px;
            color: #f1f5f9;
            cursor: pointer;
            font-size: 16px;
        }
        
        .close-history:hover {
            background: #3b82f6;
        }
        
        .history-item {
            padding: 15px;
            margin-bottom: 15px;
            background: rgba(30, 41, 59, 0.5);
            border-radius: 8px;
            border-left: 3px solid #3b82f6;
        }
        
        .history-time {
            font-weight: 600;
            color: #60a5fa;
            margin-bottom: 5px;
            font-size: 1.1rem;
        }
        
        .history-content {
            line-height: 1.6;
        }
        
        /* 乘客信息面板 */
        .passenger-info {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(15, 23, 42, 0.98);
            width: 90%;
            max-width: 600px;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.4);
            border: 1px solid rgba(100, 130, 220, 0.15);
            z-index: 100;
        }
        
        .passenger-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid rgba(100, 130, 220, 0.2);
        }
        
        .passenger-title {
            font-size: 1.8rem;
            color: #60a5fa;
            font-weight: 600;
        }
        
        .close-passenger {
            padding: 8px 20px;
            background: rgba(30, 41, 59, 0.8);
            border: 1px solid #3b82f6;
            border-radius: 6px;
            color: #f1f5f9;
            cursor: pointer;
            font-size: 16px;
        }
        
        .close-passenger:hover {
            background: #3b82f6;
        }
        
        .passenger-list {
            max-height: 400px;
            overflow-y: auto;
            margin-top: 15px;
        }
        
        .passenger-item {
            padding: 12px;
            margin-bottom: 10px;
            background: rgba(30, 41, 59, 0.5);
            border-radius: 8px;
            display: flex;
            align-items: center;
            border-left: 3px solid #3b82f6;
            transition: all 0.2s;
        }
        
        .passenger-item:hover {
            background: rgba(30, 41, 59, 0.7);
            transform: translateX(5px);
        }
        
        .passenger-id {
            width: 40px;
            font-weight: 600;
            color: #60a5fa;
            margin-right: 15px;
            text-align: center;
            font-size: 1.1rem;
        }
        
        .passenger-name {
            flex: 1;
            font-size: 1.1rem;
        }
        
        /* 响应式设计 */
        @media (max-width: 950px) {
            .title {
                font-size: 2.2rem;
            }
            
            .time-display {
                font-size: 3.5rem;
            }
            
            .game-container {
                padding: 20px;
            }
        }
        
        @media (max-width: 600px) {
            .title {
                font-size: 1.8rem;
            }
            
            .time-display {
                font-size: 2.8rem;
            }
            
            .content-area, .dialog-text {
                font-size: 16px;
                padding: 15px;
            }
            
            .passenger-details {
                flex-direction: column;
            }
        }
        
        /* 动画效果 */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .fade-in {
            animation: fadeIn 0.5s ease-out forwards;
        }
        
        /* 内容区域滚动条 */
        .content-area::-webkit-scrollbar,
        .passenger-list::-webkit-scrollbar,
        .history-panel::-webkit-scrollbar {
            width: 8px;
        }
        
        .content-area::-webkit-scrollbar-track,
        .passenger-list::-webkit-scrollbar-track,
        .history-panel::-webkit-scrollbar-track {
            background: rgba(30, 41, 59, 0.3);
            border-radius: 4px;
        }
        
        .content-area::-webkit-scrollbar-thumb,
        .passenger-list::-webkit-scrollbar-thumb,
        .history-panel::-webkit-scrollbar-thumb {
            background: #3b82f6;
            border-radius: 4px;
        }
        
        .content-area::-webkit-scrollbar-thumb:hover,
        .passenger-list::-webkit-scrollbar-thumb:hover,
        .history-panel::-webkit-scrollbar-thumb:hover {
            background: #60a5fa;
        }
        
        /* 状态指示器 */
        .status-indicator {
            display: inline-block;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: #10b981;
            margin-right: 8px;
        }
    </style>
</head>
<body>
    <div class="game-container fade-in" id="mainView">
        <div class="header">
            <h1 class="title">船长的<span>观察室</span></h1>
            <div class="subtitle">每一小时，你将有机会观察船上发生的故事</div>
        </div>
        
        <div class="time-display" id="timeDisplay">15:00</div>
        
        <div class="content-area" id="content">
            <p><span class="status-indicator"></span>欢迎船长来到观察室！现在是下午15:00，航程刚刚开始。</p>
            <br>
            <p>作为船长，你可以邀请乘客到观察室进行观察，或者回看船上其他区域之前发生的录像。</p>
            <br>
            <p>当前可以邀请的乘客有：</p>
            <div style="margin-top: 15px;">
                <span class="passenger-tag">开司 (1)</span>
                <span class="passenger-tag">赤木 (19) (3)</span>
                <span class="passenger-tag">涯 (7)</span>
            </div>
            <br>
            <p>请在输入框中输入操作指令：</p>
            <ul style="padding-left: 20px; margin-top: 10px;">
                <li>邀请乘客：输入乘客编号，如 <span class="example">1-3-7</span></li>
                <li>回看录像：输入时间-地点，如 <span class="example">16-餐厅</span></li>
                <li>查看乘客信息：输入 <span class="example">乘客 [编号]</span>，如 <span class="example">乘客 3</span></li>
                <li>查看历史记录：输入 <span class="example">历史</span></li>
            </ul>
        </div>
        
        <div class="input-section">
            <input type="text" class="search-bar" id="searchBar" placeholder="输入操作指令 (例如：1-3-7 或 16-餐厅 或 乘客 3)" autofocus>
            <button class="action-button" onclick="processInput()">执行操作</button>
        </div>
        
        <div class="info-panel" id="infoPanel">
            <p>提示：当前时间 <span class="highlight" id="currentTimeInfo">15:00</span>，你可以邀请1-4位乘客进入观察室，或回看其他房间的录像。</p>
            <p>输入 <span class="example">历史</span> 查看所有观察记录，输入 <span class="example">乘客 [编号]</span> 查看乘客详情。</p>
        </div>
    </div>
    
    <div class="game-container reading-view" id="readingView">
        <button class="back-button" onclick="backToMain()">← 返回</button>
        <div id="readingContent"></div>
    </div>
    
    <!-- 历史记录面板 -->
    <div class="history-panel" id="historyPanel">
        <div class="history-header">
            <h2 class="history-title">船长的观察记录</h2>
            <button class="close-history" onclick="closeHistory()">关闭</button>
        </div>
        <div id="historyContent"></div>
    </div>
    
    <!-- 乘客信息面板 -->
    <div class="passenger-info" id="passengerInfo">
        <div class="passenger-header">
            <h2 class="passenger-title">乘客信息</h2>
            <button class="close-passenger" onclick="closePassengerInfo()">关闭</button>
        </div>
        <div id="passengerContent"></div>
    </div>
    
    <script>
        // 场景数据
        const scenes = {
            "15-观察室-1-3": {
                title: "开司与赤木的对话",
                content: `赤木先进入房间，没过几分钟，开司也进来了

开司：你好啊，我是开司，你就是船长吗？

赤木：我不是

开司：诶，那你也是船长邀请来的？

赤木：是这样

开司：那船长在哪里呢？

赤木没有说话，向你这边看了一眼`
            },
            "15-观察室-1-7": {
                title: "开司与涯的相遇",
                content: `开司和涯同时进入观察室

开司：嘿，我是开司，你是？

涯：叫我涯就好。船长邀请我们来的？

开司：应该是吧。你觉得船长为什么要观察我们？

涯：或许他正在寻找什么...或者什么人。

两人同时望向观察室的单向玻璃`
            },
            "15-观察室-3-7": {
                title: "赤木与涯的交流",
                content: `赤木和涯在观察室相遇

涯：赤木，好久不见。没想到会在这里遇到你。

赤木：确实意外。你也是为了那个目的来的？

涯：每个人都有自己的目的，不是吗？

赤木：看来这次航行不会平静了...`
            },
            "15-观察室-1-3-7": {
                title: "三人相遇",
                content: `开司、赤木和涯同时出现在观察室

开司：哇，今天人真多！船长是在开派对吗？

赤木：安静点，开司。

涯：看来船长想观察我们之间的互动。

开司：那我们是不是应该做点有趣的事情？

三人陷入短暂的沉默，气氛微妙...`
            },
            "16-餐厅": {
                title: "森田与平山的对话",
                content: `森田：喂，小哥，你会打麻将吗？

平山：叫我吗？

森田：当然了，小哥，这里也没有别人了。

平山：会一点...怎么，你想玩？

森田：闲着也是闲着，来几局？输的人请喝酒！

平山：呵，有意思...`
            },
            "16-甲板": {
                title: "零的独处",
                content: `零独自站在甲板上，凝望远方

零：大海...总是让人平静。

（她拿出一个怀表，打开看了一眼）

零：时间不多了...得尽快找到他。

海风吹动她的长发，她的眼神变得坚定`
            },
            "16-娱乐室": {
                title: "村上与银二的较量",
                content: `村上：银二，再来一局棋如何？

银二：你昨天已经输了三次，还要来？

村上：昨天是运气不好！今天我一定赢你。

银二：那就来吧...不过输了的人要说出一个秘密。

村上：成交！`
            },
            "17-观察室-4-5-10": {
                title: "隼与鹫巢的对话",
                content: `隼：哇，鹫巢大人，他们就是，我之前打听到的，跟您进行传说一夜的人！

鹫巢：嗯？看气势还不错嘛。

隼：您觉得他们能通过考验吗？

鹫巢：这要看过才知道...不过那个穿红衣服的小子，眼神不错。

隼：那是开司，听说他很不简单...`
            },
            "17-酒吧": {
                title: "赤木(53)的独饮",
                content: `赤木(53)独自坐在酒吧角落

酒保：先生，还要再来一杯吗？

赤木：嗯...这次加冰。

酒保：您似乎心事重重？

赤木：在这船上的人，谁没有心事呢？

他望向窗外，月光洒在海面上...`
            }
        };
        
        // 乘客数据
        const passengers = {
            "1": { name: "开司" },
            "2": { name: "和也" },
            "3": { name: "赤木(19岁)" },
            "4": { name: "赤木(13岁)" },
            "5": { name: "赤木(53岁)" },
            "6": { name: "零" },
            "7": { name: "涯" },
            "8": { name: "平山" },
            "9": { name: "一条-村上" },
            "10": { name: "鹫巢岩-隼"},
            "11": { name: "银二-森田" }
        };
        
        // 当前时间（15:00开始）
        let currentTime = 15;
        
        // 历史记录
        let history = [];
        
        // 更新时间和提示信息
        function updateTime() {
            // 更新时间显示
            document.getElementById('timeDisplay').textContent = 
                `${currentTime.toString().padStart(2, '0')}:00`;
            
            // 更新信息面板中的时间
            document.getElementById('currentTimeInfo').textContent = 
                `${currentTime.toString().padStart(2, '0')}:00`;
            
            // 根据时间更新可邀请乘客
            let availablePassengers = "";
            if (currentTime === 15) {
                availablePassengers = "开司 (1), 赤木(19) (3), 涯 (7)";
            } else if (currentTime === 16) {
                availablePassengers = "零 (6), 平山 (8), 银二-森田 (11)";
            } else if (currentTime === 17) {
                availablePassengers = "赤木(13) (4), 赤木(53) (5), 鹫巢岩-隼 (10)";
            } else {
                availablePassengers = "所有乘客";
            }
            
            // 更新内容区域的提示
            const content = document.getElementById('content');
            content.innerHTML = `
                <p><span class="status-indicator"></span>现在是 ${currentTime.toString().padStart(2, '0')}:00，${currentTime < 12 ? "上午" : "下午"}</p>
                <br>
                <p>当前可以邀请的乘客有：</p>
                <div style="margin-top: 15px;">
                    ${availablePassengers.split(', ').map(p => 
                        `<span class="passenger-tag">${p}</span>`
                    ).join('')}
                </div>
                <br>
                <p>请在输入框中输入操作指令：</p>
                <ul style="padding-left: 20px; margin-top: 10px;">
                    <li>邀请乘客：输入乘客编号，如 <span class="example">1-3-7</span></li>
                    <li>回看录像：输入时间-地点，如 <span class="example">16-餐厅</span></li>
                    <li>查看乘客信息：输入 <span class="example">乘客</span></li>
                    <li>查看历史记录：输入 <span class="example">历史</span></li>
                </ul>
            `;
        }
        
        // 添加历史记录
        function addHistory(type, title, content) {
            history.push({
                time: new Date().toLocaleTimeString(),
                gameTime: `${currentTime.toString().padStart(2, '0')}:00`,
                type: type,
                title: title,
                content: content
            });
        }
        
        // 显示历史记录
        function showHistory() {
            const historyContent = document.getElementById('historyContent');
            
            if (history.length === 0) {
                historyContent.innerHTML = `<p>暂无观察记录，请开始你的观察之旅。</p>`;
                document.getElementById('historyPanel').style.display = 'block';
                return;
            }
            
            let html = '';
            history.forEach(record => {
                html += `
                    <div class="history-item">
                        <div class="history-time">${record.time} (游戏时间: ${record.gameTime})</div>
                        <div class="history-content">
                            <strong>${record.title}</strong>
                            <p>${record.content.replace(/\n/g, '<br>')}</p>
                        </div>
                    </div>
                `;
            });
            
            historyContent.innerHTML = html;
            document.getElementById('historyPanel').style.display = 'block';
        }
        
        // 显示乘客信息
        function showPassengerInfo(passengerId) {
            const passengerContent = document.getElementById('passengerContent');
            
            // 如果只输入"乘客"，显示所有乘客信息
            if (passengerId === "all") {
                let html = `<h3 class="passenger-title">全体乘客名单</h3>`;
                html += `<div class="passenger-list">`;
                
                for (const [id, info] of Object.entries(passengers)) {
                    html += `
                        <div class="passenger-item">
                            <span class="passenger-id">${id}</span>
                            <span class="passenger-name">${info.name}</span>
                        </div>
                    `;
                }
                
                html += `</div>`;
                passengerContent.innerHTML = html;
                document.getElementById('passengerInfo').style.display = 'block';
                return;
            }
            
            // 显示单个乘客信息
            const passenger = passengers[passengerId];
            if (!passenger) {
                alert('找不到该乘客信息！');
                return;
            }
            
            passengerContent.innerHTML = `
                <h3 class="passenger-name">${passenger.name}</h3>
                <div class="passenger-meta">
                    <p><strong>乘客编号：</strong> ${passengerId}</p>
                    <p><strong>房间号：</strong> ${passenger.room}</p>
                </div>
            `;
            
            document.getElementById('passengerInfo').style.display = 'block';
        }
        
        function closePassengerInfo() {
            document.getElementById('passengerInfo').style.display = 'none';
            document.getElementById('searchBar').focus();
        }
        
        // 处理用户输入
        function processInput() {
            const input = document.getElementById('searchBar').value.trim();
            if (!input) {
                alert('请输入操作指令！');
                return;
            }
            
            // 处理查看历史记录指令
            if (input === '历史' || input.toLowerCase() === 'history') {
                showHistory();
                document.getElementById('searchBar').value = '';
                return;
            }
            
            // 处理查看乘客信息指令
            if (input.startsWith('乘客')) {
                const parts = input.split(' ');
                
                // 只输入"乘客"时显示所有乘客
                if (parts.length === 1) {
                    showPassengerInfo("all");
                    document.getElementById('searchBar').value = '';
                    return;
                }
                
                // 输入"乘客 [编号]"时显示单个乘客
                const passengerId = parts[1];
                showPassengerInfo(passengerId);
                document.getElementById('searchBar').value = '';
                return;
            }
            
            // 判断是邀请乘客还是回看录像
            if (/^\d+(-\d+)*$/.test(input)) {
                // 邀请乘客
                const passengerIds = input.split('-');
                
                // 验证输入
                if (passengerIds.length < 1 || passengerIds.length > 4) {
                    alert('一次只能邀请1-4位乘客！');
                    return;
                }
                
                // 检查乘客ID是否有效
                const invalidIds = passengerIds.filter(id => !passengers[id]);
                if (invalidIds.length > 0) {
                    alert(`无效的乘客ID: ${invalidIds.join(', ')}`);
                    return;
                }
                
                // 获取乘客名字
                const passengerNames = passengerIds.map(id => passengers[id].name);
                
                // 生成场景键（当前时间-观察室-乘客ID）
                const sceneKey = `${currentTime}-观察室-${passengerIds.join('-')}`;
                
                // 查找场景
                if (scenes[sceneKey]) {
                    showReadingView(scenes[sceneKey].title, scenes[sceneKey].content);
                    addHistory('邀请', scenes[sceneKey].title, `邀请乘客: ${passengerNames.join(', ')}\n\n${scenes[sceneKey].content}`);
                } else {
                    // 如果场景不存在，使用默认场景
                    const title = `观察室 - ${passengerNames.join('、')}`;
                    const content = `你邀请了${passengerNames.join('、')}进入观察室。\n\n` +
                        `${passengerNames[0]}：船长把我们叫到这里，是有什么特别的事吗？\n` +
                        `${passengerNames[1]}：也许只是想观察我们的互动...\n` +
                        `${passengerNames[2] ? passengerNames[2] + '：' : ''}${passengerNames[2] ? '这确实是个有趣的地方...' : ''}\n\n` +
                        `他们开始交谈，你通过单向玻璃静静地观察着...`;
                    
                    showReadingView(title, content);
                    addHistory('邀请', title, `邀请乘客: ${passengerNames.join(', ')}\n\n${content}`);
                }
                
                // 推进时间
                currentTime = (currentTime % 24) + 1;
                if (currentTime === 24) currentTime = 0;
                updateTime();
                
            } else if (/^\d{1,2}-[\u4e00-\u9fa5a-zA-Z]+$/.test(input)) {
                // 回看录像
                let found = false;
                
                // 查找匹配的场景
                for (const key in scenes) {
                    if (key.startsWith(input)) {
                        showReadingView(scenes[key].title, scenes[key].content);
                        addHistory('回看', scenes[key].title, `回看录像: ${key}\n\n${scenes[key].content}`);
                        found = true;
                        break;
                    }
                }
                
                if (!found) {
                    alert('未找到相关记录！请检查输入格式是否正确。');
                }
            } else {
                alert('输入格式不正确！\n邀请乘客示例：1-3-7\n回看录像示例：16-餐厅\n查看乘客：乘客 3\n查看历史：历史');
            }
            
            // 清空输入框
            document.getElementById('searchBar').value = '';
        }
        
        // 显示阅读视图
        function showReadingView(title, content) {
            const readingContent = document.getElementById('readingContent');
            readingContent.innerHTML = `
                <h2 class="scene-title">${title}</h2>
                <div class="dialog-text">${content}</div>
            `;
            document.getElementById('mainView').style.display = 'none';
            document.getElementById('readingView').style.display = 'flex';
        }
        
        // 返回主界面
        function backToMain() {
            document.getElementById('readingView').style.display = 'none';
            document.getElementById('mainView').style.display = 'flex';
            document.getElementById('searchBar').focus();
        }
        
        // 关闭历史记录面板
        function closeHistory() {
            document.getElementById('historyPanel').style.display = 'none';
            document.getElementById('searchBar').focus();
        }
        
        // 关闭乘客信息面板
        function closePassengerInfo() {
            document.getElementById('passengerInfo').style.display = 'none';
            document.getElementById('searchBar').focus();
        }
        
        // 初始化
        window.onload = function() {
            updateTime();
            document.getElementById('searchBar').focus();
            
            // 支持按Enter键提交
            document.getElementById('searchBar').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    processInput();
                }
            });
        };
    </script>
</body>
</html>
