<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-ZK6CD9HS88"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-ZK6CD9HS88');
</script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>蟹工船</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary-color: #2c3e50;
            --secondary-color: #34495e;
            --accent-color: #e74c3c;
            --light-bg: #ecf0f1;
            --card-bg: #ffffff;
            --text-color: #2c3e50;
            --border-color: #bdc3c7;
            --talk-bg: #f8f9fa;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Microsoft YaHei', 'Segoe UI', sans-serif;
        }
        
        body {
            background: var(--light-bg);
            color: var(--text-color);
            line-height: 1.6;
            min-height: 100vh;
            transition: padding 0.3s ease;
            padding-bottom: 60px; /* 为状态栏预留空间 */
        }

        /* 导航提示样式 */
        .nav-hint {
            position: fixed;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(231, 76, 60, 0.9);
            color: white;
            padding: 15px 25px;
            border-radius: 30px;
            font-weight: bold;
            font-size: 1.1rem;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            display: flex;
            align-items: center;
            z-index: 1000;
            animation: fadeInUp 0.5s ease, pulse 2s infinite;
        }

        .nav-hint i {
            margin-right: 10px;
            font-size: 1.4rem;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translate(-50%, 30px);
            }
            to {
                opacity: 1;
                transform: translate(-50%, 0);
            }
        }

        @keyframes pulse {
            0% { box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3); }
            50% { box-shadow: 0 5px 25px rgba(231, 76, 60, 0.5); }
            100% { box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3); }
        }

        .hint-enter {
            animation: fadeInUp 0.5s ease;
        }

        .hint-exit {
            animation: fadeOutDown 0.5s ease forwards;
        }

        @keyframes fadeOutDown {
            from {
                opacity: 1;
                transform: translate(-50%, 0);
            }
            to {
                opacity: 0;
                transform: translate(-50%, 30px);
            }
        }
        
        .header {
            padding: 20px;
            text-align: center;
            background: var(--card-bg);
            border-bottom: 2px solid var(--primary-color);
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease;
        }
        
        .title {
            font-size: 2.2rem;
            color: var(--primary-color);
            margin-bottom: 5px;
        }
        
        .subtitle {
            font-size: 1.1rem;
            color: var(--secondary-color);
            margin-bottom: 10px;
        }
        
        .notice {
            background: linear-gradient(to right, #c0392b, #e74c3c);
            color: #fff;
            font-weight: bold;
            padding: 14px;
            text-align: center;
            max-width: 800px;
            margin: 20px auto;
            border-radius: 8px;
            border: 2px solid #e74c3c;
            box-shadow: 0 0 15px rgba(231, 76, 60, 0.3);
            animation: pulse 2s infinite;
        }
        
        .comic-container {
            max-width: 800px;
            margin: 0 auto;
            padding: 15px;
        }
        
        .comic-image {
            display: block;
            width: 100%;
            height: auto;
            margin-bottom: 15px;
            border-radius: 8px;
            background: #f8f9fa;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
            border: 1px solid var(--border-color);
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.5s ease;
        }
        
        .comic-image.loaded {
            opacity: 1;
            transform: translateY(0);
        }
        
        .loading-container {
            text-align: center;
            padding: 50px 20px;
            color: #6c757d;
            font-size: 1.2rem;
        }
        
        .loading-spinner {
            width: 50px;
            height: 50px;
            border: 5px solid rgba(44, 62, 80, 0.2);
            border-top: 5px solid var(--primary-color);
            border-radius: 50%;
            margin: 0 auto 20px;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* 碎碎念区域样式 */
        .talk-section {
            background: var(--talk-bg);
            border-radius: 10px;
            padding: 25px;
            margin: 30px auto;
            max-width: 800px;
            border-left: 4px solid var(--primary-color);
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.05);
        }
        
        .talk-content {
            line-height: 1.8;
            font-size: 1.1rem;
        }
        
        .talk-content p {
            margin-bottom: 15px;
        }
        
        .footer {
            background: var(--card-bg);
            padding: 30px 20px;
            text-align: center;
            margin-top: 30px;
            border-top: 1px solid var(--border-color);
            box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.05);
            transition: transform 0.3s ease;
        }
        
        .footer-title {
            color: var(--primary-color);
            font-size: 1.4rem;
            margin-bottom: 20px;
            font-weight: bold;
        }
        
        .staff-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            max-width: 800px;
            margin: 0 auto;
        }
        
        .staff-item {
            background: #f8fbff;
            padding: 12px;
            border-radius: 8px;
            border: 1px solid var(--border-color);
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
        }
        
        .staff-role {
            font-weight: bold;
            color: var(--primary-color);
            margin-bottom: 5px;
        }
        
        .staff-name {
            font-size: 1.1rem;
            color: #555;
        }
        
        .status-bar {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            background: rgba(255, 255, 255, 0.95);
            padding: 12px;
            font-size: 1rem;
            text-align: center;
            color: var(--primary-color);
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 10px;
            z-index: 100;
            transition: transform 0.3s ease;
            border-top: 1px solid var(--border-color);
            box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.1);
        }
        
        .progress-container {
            width: 200px;
            height: 8px;
            background: rgba(44, 62, 80, 0.1);
            border-radius: 4px;
            overflow: hidden;
        }
        
        .progress-bar {
            height: 100%;
            background: linear-gradient(to right, var(--primary-color), var(--secondary-color));
            width: 0%;
            transition: width 0.3s ease;
        }
        
        .completed-message {
            color: #28a745;
            font-weight: bold;
            display: none;
        }
        
        /* 导航菜单样式 */
        .nav-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255, 255, 255, 0.95);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 200;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }
        
        .nav-overlay.active {
            opacity: 1;
            visibility: visible;
        }
        
        .nav-buttons {
            display: flex;
            gap: 30px;
        }
        
        .nav-btn {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            background: #fff;
            border: 2px solid var(--primary-color);
            color: var(--primary-color);
            font-size: 1.1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        .nav-btn i {
            font-size: 2.5rem;
            margin-bottom: 8px;
        }
        
        .nav-btn:hover {
            background: var(--primary-color);
            color: white;
            transform: scale(1.1);
        }
        
        .nav-btn.prev {
            border-color: var(--primary-color);
        }
        
        .nav-btn.next {
            border-color: var(--primary-color);
        }
        
        .nav-btn.center {
            background: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
        }
        
        .nav-btn.center:hover {
            background: #1a252f;
        }
        
        .nav-btn.disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .nav-btn.disabled:hover {
            transform: none;
            background: #fff;
            color: var(--primary-color);
        }
        
        /* 隐藏页眉页脚的状态 */
        .header.hidden {
            transform: translateY(-100%);
        }
        
        .footer.hidden, .status-bar.hidden {
            transform: translateY(100%);
        }
        
        /* 最后一页检测 */
        .end-indicator {
            height: 1px;
            position: absolute;
            bottom: 300px; /* 在底部留出空间 */
            width: 100%;
        }
        
        @media (max-width: 600px) {
            .title {
                font-size: 1.8rem;
            }
            
            .subtitle {
                font-size: 1rem;
            }
            
            .staff-grid {
                grid-template-columns: 1fr;
            }
            
            .nav-buttons {
                flex-direction: column;
                gap: 20px;
            }
            
            .nav-btn {
                width: 80px;
                height: 80px;
                font-size: 0.9rem;
            }
            
            .nav-btn i {
                font-size: 2rem;
            }
            
            .talk-section {
                padding: 20px;
                margin: 20px 15px;
            }
        }
    </style>
</head>
<body>
    <div class="header" id="header">
        <div class="title" id="chapterTitle">蟹工船</div>
        <div class="subtitle" id="chapterSubtitle">中文汉化版 | Cloudinary CDN加速</div>
    </div>
    
    <div class="notice">
        本汉化仅作学习参考交流使用，不可以任何形式进行盈利。
    </div>
    
    <div class="comic-container" id="comic-container">
        <div class="loading-container">
            <div class="loading-spinner"></div>
            <p>正在加载漫画，请稍候...</p>
            <p><i class="fas fa-cloud"></i> 使用Cloudinary CDN加速中</p>
        </div>
    </div>
    
    <!-- 碎碎念区域 -->
    <div class="talk-section" id="talkSection">
        <div class="talk-content" id="talkContent">
            <!-- 由JavaScript动态生成 -->
        </div>
    </div>
    
    <div class="footer" id="footer">
        <div class="footer-title">制作人员</div>
        <div class="staff-grid" id="staffGrid">
            <!-- 由JavaScript动态生成 -->
        </div>
    </div>
    
    <div class="status-bar" id="statusBar">
        <i class="fas fa-spinner fa-spin"></i>
        <span>加载进度: <span id="loadedCount">0</span>/<span id="totalCount">0</span></span>
        <div class="progress-container">
            <div class="progress-bar" id="progressBar"></div>
        </div>
        <span class="completed-message" id="completedMessage"><i class="fas fa-check-circle"></i> 加载完成!</span>
    </div>
    
    <!-- 导航菜单 -->
    <div class="nav-overlay" id="navOverlay">
        <div class="nav-buttons">
            <div class="nav-btn prev" id="prevBtn">
                <i class="fas fa-arrow-left"></i>
                上一章
            </div>
            <div class="nav-btn center" id="homeBtn">
                <i class="fas fa-home"></i>
                目录
            </div>
            <div class="nav-btn next" id="nextBtn">
                <i class="fas fa-arrow-right"></i>
                下一章
            </div>
        </div>
    </div>
    
    <!-- 最后一页检测元素 -->
    <div class="end-indicator" id="endIndicator"></div>
    
<script>
        // 显示导航提示
        function showNavHint() {
            // 创建提示元素
            const hint = document.createElement('div');
            hint.className = 'nav-hint hint-enter';
            hint.innerHTML = '<i class="fas fa-hand-pointer"></i> 点击页面任意位置显示导航菜单';
            document.body.appendChild(hint);
            
            // 3秒后自动隐藏
            const hideTimer = setTimeout(() => {
                hint.classList.remove('hint-enter');
                hint.classList.add('hint-exit');
                
                // 动画结束后移除元素
                setTimeout(() => {
                    if (document.body.contains(hint)) {
                        document.body.removeChild(hint);
                    }
                }, 500);
            }, 5000);
            
            // 点击页面时立即隐藏提示
            document.body.addEventListener('click', function hideOnClick() {
                clearTimeout(hideTimer);
                hint.classList.remove('hint-enter');
                hint.classList.add('hint-exit');
                
                setTimeout(() => {
                    if (document.body.contains(hint)) {
                        document.body.removeChild(hint);
                    }
                    // 移除事件监听
                    document.body.removeEventListener('click', hideOnClick);
                }, 500);
            }, { once: true });
        }

        // 页面加载完成后显示提示
        document.addEventListener('DOMContentLoaded', showNavHint);
        // ========================
        // 配置区域 - 只需修改这部分
        // ========================
        
        // 当前章节配置
        const chapterConfig = {
            chapterNumber: 5, // 章节编号 (1-5)
            imageUrls: [ // 图片URL数组 - 请替换为蟹工船的实际图片URL
                
             "https://res.cloudinary.com/dbulxrm7b/image/upload/v1761029233/168_jdxziy.png",
             "https://res.cloudinary.com/dbulxrm7b/image/upload/v1761029228/169_svfvmj.png",
             "https://res.cloudinary.com/dbulxrm7b/image/upload/v1761029228/170_hcac3m.png",
             "https://res.cloudinary.com/dbulxrm7b/image/upload/v1761029230/171_yojfa7.png",
             "https://res.cloudinary.com/dbulxrm7b/image/upload/v1761029235/172_m21evr.png",
             "https://res.cloudinary.com/dbulxrm7b/image/upload/v1761029235/174_d9x9a9.png",
             "https://res.cloudinary.com/dbulxrm7b/image/upload/v1761029232/175_ddvk0o.png",
             "https://res.cloudinary.com/dbulxrm7b/image/upload/v1761029238/176_k2dwwo.png",
             "https://res.cloudinary.com/dbulxrm7b/image/upload/v1761029235/177_hfhd2q.png",
             "https://res.cloudinary.com/dbulxrm7b/image/upload/v1761029235/178_wwbsgs.png",
             "https://res.cloudinary.com/dbulxrm7b/image/upload/v1761029240/179_btckq6.png",
             "https://res.cloudinary.com/dbulxrm7b/image/upload/v1761029238/180_j3qrm5.png",
             "https://res.cloudinary.com/dbulxrm7b/image/upload/v1761029243/181_kfbmco.png",
             "https://res.cloudinary.com/dbulxrm7b/image/upload/v1761029240/182_b5pgdb.png",
             "https://res.cloudinary.com/dbulxrm7b/image/upload/v1761029248/183_hvyvfr.png",
             "https://res.cloudinary.com/dbulxrm7b/image/upload/v1761029249/184_slygyt.png",
             "https://res.cloudinary.com/dbulxrm7b/image/upload/v1761029245/185_rxnqel.png",
             "https://res.cloudinary.com/dbulxrm7b/image/upload/v1761029245/186_sxcxtg.png",
             "https://res.cloudinary.com/dbulxrm7b/image/upload/v1761029251/187_qkwrgg.png",
             "https://res.cloudinary.com/dbulxrm7b/image/upload/v1761029247/188_co5wmh.png",
             "https://res.cloudinary.com/dbulxrm7b/image/upload/v1761029249/189_pxaqse.png",
             "https://res.cloudinary.com/dbulxrm7b/image/upload/v1761029251/190_nhtja1.png",
             "https://res.cloudinary.com/dbulxrm7b/image/upload/v1761029252/191_bklttx.png",
             "https://res.cloudinary.com/dbulxrm7b/image/upload/v1761029257/192_s8ql8g.png",
             "https://res.cloudinary.com/dbulxrm7b/image/upload/v1761029259/193_terge6.png",
             "https://res.cloudinary.com/dbulxrm7b/image/upload/v1761029264/194_hetitv.png",
             "https://res.cloudinary.com/dbulxrm7b/image/upload/v1761029259/195_eywmro.png",
             "https://res.cloudinary.com/dbulxrm7b/image/upload/v1761029265/196_snfgsy.png",
             "https://res.cloudinary.com/dbulxrm7b/image/upload/v1761029264/198_tvc8vz.png",
             "https://res.cloudinary.com/dbulxrm7b/image/upload/v1761029264/199_jqkm0v.png",
             "https://res.cloudinary.com/dbulxrm7b/image/upload/v1761029268/200_vut6qx.png",
             "https://res.cloudinary.com/dbulxrm7b/image/upload/v1761029265/201_xooaen.png",
             "https://res.cloudinary.com/dbulxrm7b/image/upload/v1761029266/202_cjyhoa.png",
             "https://res.cloudinary.com/dbulxrm7b/image/upload/v1761029278/203_hjj8b1.png",
             "https://res.cloudinary.com/dbulxrm7b/image/upload/v1761029273/204_fh3tyh.png",
             "https://res.cloudinary.com/dbulxrm7b/image/upload/v1761029274/205_mbowpx.png",
             "https://res.cloudinary.com/dbulxrm7b/image/upload/v1761029275/206_pnw4r3.png",
             "https://res.cloudinary.com/dbulxrm7b/image/upload/v1761029276/207_xjv5ga.png",
             "https://res.cloudinary.com/dbulxrm7b/image/upload/v1761029280/208_fyhwfp.png",
             "https://res.cloudinary.com/dbulxrm7b/image/upload/v1761029282/209_abgbm9.png"
         




            ],
            staffMembers: [ // 制作人员
                { role: "图源", name: "月月公爵" },
                { role: "翻译", name: "Deco" },
                { role: "修图", name: "Deco" },
                { role: "嵌字", name: "Deco" }
            ],
            talkContent: `
                <p>解说(东京大学大学院教授　小森阳一)</p>
                <p>关于《蟹工船》这部作品，最准确、最简洁的评论，其实是作者小林多喜二自己写下的。在完成《蟹工船》的次日，即1929年3月31日寄给藏原惟人的书信中，多喜二用七点概括了自己小说的特征。</p> 
                 <p>〈一、这部作品没有「主人公」也没有那种「传记体式」的主角人物。作为主人公登场的是劳动的「集体（group）」。〉</p> 
                  <p> 这里重要的是，「集体」特地标注了「グループ（group）」的读法。藏原似乎把它粗略理解成了「劳动者的集合体」，其实并非如此。多喜二意在把「蟹工船」这一空间里，参与总体「劳动」的诸个群体分别写出：一边是渔工、杂工、水手、炉工、木工等的群体；另一边是掌控「蟹工船」的工厂代表、监工、船长、杂工长等人 —— 他要描画的，正是这些群体之间的权力关系。</p> 
                   <p>〈二、因此，这部作品就不像《一九二八·三·一五》等先前作品那样，去描写每个个体的性格与心理。〉   在这一点上，藏原批评说：「为了描写集体，难道就可以把个人完全埋没吗？」—— 这也是一种误解。多喜二想要记录的，是在特定的 「劳动」的在场方式之下，个体意识如何在「集体」内部被规训。</p> 
                    <p>〈三、为了使无产阶级艺术实现「大众化」，我在形式层面做了多种努力。〉〈我的（1）这部作品首先是压倒性地「劳动者的」、（2）正是在这种把「劳动」强力带入文本之中，我看到了大众化的原则。这部作品里没有「摩登式」的明快，也没有「节奏的轻快」。〉</p> 
                     <p> 对此，藏原批评作品「缺乏无产阶级健康的明朗」，但只能说他并没有抓住情节的要旨。那些「为了活命才在《蟹工船》上干活」的劳动者，在直面同伴之死时，获得了「不想死（在堪察加）」的体认，并理解到「他们确实是被杀死的」。而当这种体认转变为「我们现在正被一点点地杀掉」的瞬间，劳动者就会站起来。把「生」在与「死」的牵连中重新认识为「被杀害」的过程之处，正存在著资本主义剥削的现实 ——「我们的生存其本身正受到威胁」的证据（参见《周刊 Comic Bunch》2008 年 10 月 31 日号雨宫处凛的专栏）—— 也正存在著 「劳动者的」感受性 。所谓「半吊子的明朗」，完全没有必要。</p>  
               <p>     〈四、本作《蟹工船》所描绘的，是一种特殊的劳动形态。〉〈A、这种劳动形态，是殖民地、未开化地区特有的典型剥削。B、除东京、大阪等大型工业地区外，在当时日本劳动者的实际处境中，类似情况仍占比约 80%。C、此外，还能以近乎透明的清晰度，看到各类国际关系、军事关系与经济关系在此相互贯通。〉</p>
   <p>如小说正文（本书第 27 页所画），「蟹工船」位于一个不适用《航海法》《工厂法》、法律被停止执行的无法空间之中。那里成了与国家权力相连、能把资本与军队一并引入者的「随心所欲之地」，也就是一种 「殖民地式」空间 。对那种无法空间的「护卫」式描写，呈现的正是在与苏联接壤的边境地带〔堪察加〕进行的战争准备。德国政治学家卡尔・施米特认为，停止法律的执行本身就是战争状态。监督浅川高喊：「既然这份工作具有国家性质，那就和战争一样。抱著必死的觉悟去干！」—— 是的，《蟹工船》就是一处战场。</p>
      <p>〈五、本作描写的是未组织化的劳动者。〉</p>
         <p>〈六、资本主义一方面意图让劳动者保持未组织化，但反过来又（哪怕是自然发生地）促成了组织化。〉</p>
            <p> 这正是二十一世纪「当下《蟹工船》热」的最大原因。这个国家的工会长期无视许多在贫困与固化差距中挣扎的年轻劳动者的「生存本身受到威胁」。在「要么活下去要么被杀」的临界线上，个人加入型联合会（union）为他们托住了迈向救援的第一步。正如若干实例所示，在当代日本，「未组织」的困窘者开始相互连结，甚至自发地相互「组织」；对此的高度关心，也带来了《蟹工船》的走红。</p>
               <p>〈七、无产阶级必须绝对反对帝国主义的战争。〉〈必须把帝国军队——财阀——国际关系——劳动者这些方面作为一个整体去看。为此，《蟹工船》提供了最好的舞台。〉</p>

       <p>的确如此 ——《蟹工船》是把握当下资本主义现状之「整体性」不可或缺的文本。</p>  
            <p>各位读者可以在「现在」，以漫画的形式继续阅读《蟹工船》。原惠一郎在改编中设置了一位原作中并不存在的青年，把他当作进入《蟹工船》世界的引路人。这个无名的青年成为再次发动罢工的召集者，引导读者同行。</p>   
                <p> 既然做成漫画，「是否就必须把每个人的脸和身体都画为中心形象？」—— 这个疑问在本书里已经得到解决。并且，并未把具名人物塑造成小说的中心人物，而是让其充当催化者；如此一来，既不损害多喜二的意图，也让「主人公是『集体』」得到可视化实现。原惠一郎把小林多喜二 6 月 20 日来信中的那句话 ——「我打算在下一部作品里以献身的态度把欠下的都清算」—— 跨越时间地漂亮呈现了出来。</p>



                `


        };
        
        // ========================
        // 自动优化模块 - 自动添加压缩参数 (您无需修改此部分)
        // ========================
        (function optimizeCloudinaryUrls() {
            // 智能添加压缩参数到所有Cloudinary URL
            chapterConfig.imageUrls = chapterConfig.imageUrls.map(url => {
                if (!url.includes('res.cloudinary.com')) return url; // 非Cloudinary链接保持原样
                
                // 检查是否已有优化参数
                if (url.includes('/f_') || url.includes('/q_')) return url;
                
                // 在/upload/后添加优化参数
                return url.replace(
                    /(https:\/\/res\.cloudinary\.com\/[^/]+\/image\/upload\/)(v\d+\/)/, 
                    '$1f_auto,q_auto/$2'
                );
            });
        })();
// ========================
// 脚本代码 - 无需修改
// ========================
        
        document.addEventListener('DOMContentLoaded', function() {
            // 设置章节标题
            document.getElementById('chapterTitle').textContent = `蟹工船 第${chapterConfig.chapterNumber}章`;
            document.getElementById('chapterSubtitle').textContent = `中文汉化版`;
            
            // 设置制作人员
            const staffGrid = document.getElementById('staffGrid');
            chapterConfig.staffMembers.forEach(member => {
                const staffItem = document.createElement('div');
                staffItem.className = 'staff-item';
                staffItem.innerHTML = `
                    <div class="staff-role">${member.role}</div>
                    <div class="staff-name">${member.name}</div>
                `;
                staffGrid.appendChild(staffItem);
            });
            
            // 设置碎碎念内容
            document.getElementById('talkContent').innerHTML = chapterConfig.talkContent;
            
            const comicContainer = document.getElementById('comic-container');
            const statusBar = document.getElementById('statusBar');
            const loadedCount = document.getElementById('loadedCount');
            const totalCount = document.getElementById('totalCount');
            const progressBar = document.getElementById('progressBar');
            const header = document.getElementById('header');
            const footer = document.getElementById('footer');
            const statusBarEl = document.getElementById('statusBar');
            const navOverlay = document.getElementById('navOverlay');
            const prevBtn = document.getElementById('prevBtn');
            const homeBtn = document.getElementById('homeBtn');
            const nextBtn = document.getElementById('nextBtn');
            const endIndicator = document.getElementById('endIndicator');
            const talkSection = document.getElementById('talkSection');
            
            // 滚动变量
            let lastScrollTop = 0;
            let isNearBottom = false;
            
            totalCount.textContent = chapterConfig.imageUrls.length;
            
            // 移除加载提示
            comicContainer.innerHTML = '';
            
            // 创建并添加所有漫画图片
            chapterConfig.imageUrls.forEach((url, index) => {
                const imgContainer = document.createElement('div');
                imgContainer.className = 'img-container';
                
                const img = document.createElement('img');
                // 修改这里，初始时不加载图片
                img.dataset.src = url; // 使用data-src代替src
                img.alt = `第 ${index + 1} 页`;
                img.className = 'comic-image';
                img.loading = "lazy"; // 添加懒加载属性
                
                // 修改图片加载逻辑
                const loadImage = function() {
                    if (img.dataset.src) {
                        img.src = img.dataset.src;
                        delete img.dataset.src;
                    }
                };
                
                // 当图片进入视口时加载
                const observer = new IntersectionObserver((entries) => {
                    entries.forEach(entry => {
                        if (entry.isIntersecting) {
                            loadImage();
                            observer.unobserve(entry.target);
                        }
                    });
                });
                
                observer.observe(img);
                
                // 添加图片加载状态监听
                img.onload = function() {
                    this.classList.add('loaded');
                    
                    // 更新加载计数
                    const loaded = parseInt(loadedCount.textContent) + 1;
                    loadedCount.textContent = loaded;
                    
                    // 更新进度条
                    const progress = Math.floor((loaded / chapterConfig.imageUrls.length) * 100);
                    progressBar.style.width = `${progress}%`;
                    
                    // 当所有图片加载完成时
                    if (loaded === chapterConfig.imageUrls.length) {
                        setTimeout(() => {
                            statusBar.innerHTML = '<i class="fas fa-check-circle"></i> 所有图片加载完成!';
                            statusBar.style.color = '#28a745';
                            
                            // 将最后一页检测元素放在所有内容之后
                            document.body.appendChild(endIndicator);
                        }, 500);
                    }
                };
                
                img.onerror = function() {
                    this.src = 'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="400" height="600" viewBox="0 0 400 600"><rect width="400" height="600" fill="%23f8f9fa"/><text x="200" y="300" font-family="Arial" font-size="20" fill="%236c757d" text-anchor="middle">图片加载失败</text></svg>';
                    this.classList.add('loaded');
                    
                    // 更新加载计数
                    const loaded = parseInt(loadedCount.textContent) + 1;
                    loadedCount.textContent = loaded;
                    
                    // 更新进度条
                    const progress = Math.floor((loaded / chapterConfig.imageUrls.length) * 100);
                    progressBar.style.width = `${progress}%`;
                };
                
                // 添加页码标签
                const pageNum = document.createElement('div');
                pageNum.className = 'page-number';
                pageNum.textContent = `第 ${index + 1} 页`;
                pageNum.style.textAlign = 'center';
                pageNum.style.margin = '5px 0 15px';
                pageNum.style.color = '#6c757d';
                pageNum.style.fontSize = '0.9rem';
                
                imgContainer.appendChild(img);
                imgContainer.appendChild(pageNum);
                comicContainer.appendChild(imgContainer);
            });
            
            // 滚动时隐藏页眉页脚（优化版）
            window.addEventListener('scroll', function() {
                const currentScroll = window.pageYOffset || document.documentElement.scrollTop;
                const windowHeight = window.innerHeight;
                const documentHeight = Math.max(
                    document.body.scrollHeight, 
                    document.body.offsetHeight, 
                    document.documentElement.clientHeight, 
                    document.documentElement.scrollHeight, 
                    document.documentElement.offsetHeight
                );
                
                // 计算距离底部的距离
                const distanceToBottom = documentHeight - (currentScroll + windowHeight);
                
                // 如果接近底部（1200像素内），显示所有元素
                if (distanceToBottom < 1200) {
                    header.classList.remove('hidden');
                    footer.classList.remove('hidden');
                    statusBarEl.classList.remove('hidden');
                    isNearBottom = true;
                    return;
                } else {
                    isNearBottom = false;
                }
                
                // 向下滚动超过50px时隐藏
                if (currentScroll > lastScrollTop && currentScroll > 50) {
                    header.classList.add('hidden');
                    footer.classList.add('hidden');
                    statusBarEl.classList.add('hidden');
                } 
                // 向上滚动或到顶部时显示
                else {
                    header.classList.remove('hidden');
                    footer.classList.remove('hidden');
                    statusBarEl.classList.remove('hidden');
                }
                
                lastScrollTop = currentScroll <= 0 ? 0 : currentScroll;
            });
            
            // 点击中间区域显示导航菜单
            document.body.addEventListener('click', function(e) {
                // 排除按钮点击
                if (e.target.closest('.nav-btn')) return;
                
                // 切换导航菜单显示状态
                navOverlay.classList.toggle('active');
            });
            
            // 导航按钮功能
            prevBtn.addEventListener('click', function() {
                if (chapterConfig.chapterNumber > 1) {
                    window.location.href = `chapter-${chapterConfig.chapterNumber - 1}.html`;
                } else {
                    alert('已经是第一章了');
                }
            });
            
            homeBtn.addEventListener('click', function() {
                // 跳转到目录页 - 请替换为您的实际目录页路径
                window.location.href = 'https://deco808.github.io/waxizi/index.html';
            });
            
            nextBtn.addEventListener('click', function() {
                if (chapterConfig.chapterNumber < 5) {
                    window.location.href = `chapter-${chapterConfig.chapterNumber + 1}.html`;
                } else {
                    alert('已经是最后一章了');
                }
            });
            
            // 初始时隐藏碎碎念区域，在滚动到末尾时显示
            talkSection.style.opacity = '0';
            talkSection.style.transform = 'translateY(20px)';
            talkSection.style.transition = 'all 0.5s ease';
            
            // 滚动到末尾时显示碎碎念区域
            window.addEventListener('scroll', function() {
                const talkSectionRect = talkSection.getBoundingClientRect();
                const windowHeight = window.innerHeight;
                
                // 当碎碎念区域进入视口时显示
                if (talkSectionRect.top < windowHeight * 0.8) {
                    talkSection.style.opacity = '1';
                    talkSection.style.transform = 'translateY(0)';
                }
            });
        });
    </script>
</body>
</html>